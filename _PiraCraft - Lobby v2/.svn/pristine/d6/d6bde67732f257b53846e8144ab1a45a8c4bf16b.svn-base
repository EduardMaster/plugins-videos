package br.com.piracraft.lobby2.listeners;

import java.util.HashMap;

import org.bukkit.Bukkit;
import org.bukkit.entity.Player;
import org.bukkit.event.EventHandler;
import org.bukkit.event.Listener;
import org.bukkit.event.player.PlayerJoinEvent;
import org.bukkit.event.player.PlayerMoveEvent;
import org.bukkit.plugin.Plugin;
import org.bukkit.scheduler.BukkitRunnable;

public class KickPlayerOnAfk implements Listener {

	private static final long TIME = 5 * 60 * 1000;
	private static final HashMap<Player, Long> TIMES = new HashMap<>();
	private static final String MESSAGE = "";

	static{
		
		
		
	}
	public KickPlayerOnAfk(Plugin plugin) {
		new BukkitRunnable() {

			@Override
			public void run() {
				for (Player p : Bukkit.getOnlinePlayers()) {
					Long time = TIMES.get(p);
					long now = System.currentTimeMillis();
					if (now > TIME + time) {
						TIMES.remove(p);
						p.kickPlayer(MESSAGE);;
						TIMES.remove(p);
					}
				}
			}
		}.runTaskTimer(plugin, 20, 20);
	}

	@EventHandler
	public void event(PlayerJoinEvent e) {
		Player p = e.getPlayer();
		TIMES.put(p, System.currentTimeMillis());
	}

	@EventHandler
	public void event(PlayerMoveEvent e) {
		Player p = e.getPlayer();
		TIMES.put(p, System.currentTimeMillis());
	}

}
